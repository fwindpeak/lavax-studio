# LavStudio é—­ç¯æµ‹è¯•æŒ‡å—

> éªŒè¯ æºç  â†’ ç¼–è¯‘ â†’ è¿è¡Œ â†’ åç¼–è¯‘ â†’ ç¼–è¯‘ â†’ è¿è¡Œ çš„å®Œæ•´æµç¨‹

## ğŸ¯ æµ‹è¯•ç›®æ ‡

å®ç°å®Œæ•´çš„é—­ç¯éªŒè¯ï¼š
```
C æºç  â”€â”€ç¼–è¯‘å™¨â”€â”€> æ±‡ç¼–ä»£ç  â”€â”€æ±‡ç¼–å™¨â”€â”€> LAV å­—èŠ‚ç 
    â†‘                                          â†“
    â””â”€â”€â”€â”€â”€â”€â”€â”€åç¼–è¯‘å™¨ï¼ˆç›®æ ‡ï¼‰â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è™šæ‹Ÿæœºæ‰§è¡Œ
```

**æˆåŠŸæ ‡å‡†**: åç¼–è¯‘åçš„æºç èƒ½å†æ¬¡ç¼–è¯‘å¹¶äº§ç”Ÿç›¸åŒè¡Œä¸º

## ğŸš€ è¿è¡Œæµ‹è¯•

```bash
cd /Users/kai/code/myprj/lavax-studio
bun run tests/loop_closure_test.ts
```

## ğŸ“Š æµ‹è¯•ç”¨ä¾‹

### æµ‹è¯• 1: ç®€å•ç®—æœ¯
```c
void main() {
    int a = 10;
    int b = 20;
    int c = a + b;
    printf("Result: %d\n", c);
}
```
é¢„æœŸè¾“å‡º: `Result: 30`

### æµ‹è¯• 2: æ•°ç»„æ“ä½œ
```c
void main() {
    int arr[3] = {1, 2, 3};
    int i;
    for (i = 0; i < 3; i++) {
        printf("%d ", arr[i]);
    }
    printf("\n");
}
```
é¢„æœŸè¾“å‡º: `1 2 3 `

### æµ‹è¯• 3: å‡½æ•°è°ƒç”¨
```c
int add(int a, int b) {
    return a + b;
}

void main() {
    int result = add(5, 3);
    printf("5 + 3 = %d\n", result);
}
```
é¢„æœŸè¾“å‡º: `5 + 3 = 8`

## âœ… å½“å‰çŠ¶æ€

| é˜¶æ®µ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| æºç  â†’ æ±‡ç¼– | âœ… å¯ç”¨ | ç¼–è¯‘å™¨åŸºæœ¬åŠŸèƒ½å®Œæ•´ |
| æ±‡ç¼– â†’ LAV | âœ… å¯ç”¨ | æ±‡ç¼–å™¨ç¨³å®š |
| LAV â†’ è¿è¡Œ | âœ… å¯ç”¨ | VM æ‰§è¡Œæ­£å¸¸ï¼Œæ ˆä¸‹æº¢å·²ä¿®å¤ |
| LAV â†’ åç¼–è¯‘ | âš ï¸ éƒ¨åˆ† | ç”Ÿæˆä¼ªä»£ç ï¼Œéœ€å®Œå–„ |
| åç¼–è¯‘ â†’ æºç  | âŒ æœªå®Œæˆ | å½“å‰è¾“å‡ºä¸å¯ç¼–è¯‘ |

## ğŸ”§ å·²çŸ¥é™åˆ¶

1. **åç¼–è¯‘å™¨è¾“å‡ºä¸å¯ç¼–è¯‘**
   - ç”Ÿæˆçš„æ˜¯ä¼ªä»£ç ï¼ˆå¸¦æ³¨é‡Šçš„æ±‡ç¼–é£æ ¼ï¼‰
   - éœ€è¦å®ç°æ§åˆ¶æµåˆ†ææ‰èƒ½ç”Ÿæˆæœ‰æ•ˆ C ä»£ç 

2. **æ§åˆ¶ç»“æ„ä¸¢å¤±**
   - åç¼–è¯‘å if/else/while/for å˜æˆ goto é£æ ¼
   - éœ€è¦å®ç°æ§åˆ¶æµç»“æ„åŒ–åˆ†æ

3. **å˜é‡ç±»å‹æ¨æ–­ä¸å®Œæ•´**
   - æ•°ç»„å¤§å°æ— æ³•å‡†ç¡®æ¨æ–­
   - éœ€è¦æ•°æ®æµåˆ†ææ”¹è¿›

## ğŸ¯ ä¸‹ä¸€æ­¥å·¥ä½œ

### é«˜ä¼˜å…ˆçº§
1. **æ§åˆ¶æµç»“æ„åŒ–**
   - è¯†åˆ« if/else æ¨¡å¼
   - è¯†åˆ« while/for å¾ªç¯
   - å°† goto è½¬æ¢ä¸ºç»“æ„åŒ–ä»£ç 

2. **ç”Ÿæˆå¯ç¼–è¯‘ C ä»£ç **
   - æœ‰æ•ˆçš„å˜é‡å£°æ˜
   - æ­£ç¡®çš„å‡½æ•°ç­¾å
   - æ ‡å‡†çš„ C è¯­æ³•

### ä¸­ä¼˜å…ˆçº§
3. **æ•°ç»„æ”¯æŒå®Œå–„**
   - å‡†ç¡®è¯†åˆ«æ•°ç»„è®¿é—®
   - æ¢å¤æ•°ç»„åˆå§‹åŒ–å€¼
   - å¤šç»´æ•°ç»„æ”¯æŒ

4. **æŒ‡é’ˆæ”¯æŒ**
   - è¯†åˆ«æŒ‡é’ˆè¿ç®—
   - æ­£ç¡®çš„ç±»å‹è½¬æ¢

## ğŸ’¡ ä½¿ç”¨å»ºè®®

å½“å‰åç¼–è¯‘å™¨é€‚åˆï¼š
- âœ… ç†è§£æœªçŸ¥ LAV æ–‡ä»¶çš„åŠŸèƒ½
- âœ… è°ƒè¯•ç¼–è¯‘å™¨è¾“å‡º
- âœ… å­¦ä¹  LavaX æ±‡ç¼–

ä¸é€‚åˆï¼š
- âŒ ç›´æ¥ä¿®æ”¹åé‡æ–°ç¼–è¯‘ï¼ˆè¾“å‡ºä¸å¯ç¼–è¯‘ï¼‰
- âŒ å®Œå…¨æ›¿ä»£æºç ï¼ˆä¿¡æ¯ä¸¢å¤±ï¼‰

## ğŸ§ª æ‰‹åŠ¨éªŒè¯é—­ç¯

```typescript
import { LavaXCompiler } from './src/compiler';
import { LavaXAssembler } from './src/compiler/LavaXAssembler';
import { LavaXVM } from './src/vm';
import { LavaXDecompiler } from './src/decompiler';

// 1. ç¼–è¯‘
const compiler = new LavaXCompiler();
const asm = compiler.compile(source);

// 2. æ±‡ç¼–
const assembler = new LavaXAssembler();
const lav = assembler.assemble(asm);

// 3. è¿è¡Œ
const vm = new LavaXVM();
vm.load(lav);
await vm.run();

// 4. åç¼–è¯‘
const decompiler = new LavaXDecompiler();
const decompiledSource = decompiler.decompile(lav);
console.log(decompiledSource);

// 5. å†æ¬¡ç¼–è¯‘ï¼ˆå½“å‰ä¼šå¤±è´¥ï¼‰
const asm2 = compiler.compile(decompiledSource);
// é¢„æœŸ: æˆåŠŸç¼–è¯‘
// å®é™…: å¯èƒ½å¤±è´¥ï¼Œå› ä¸ºåç¼–è¯‘è¾“å‡ºæ˜¯ä¼ªä»£ç 
```

---

*æœ€åæ›´æ–°ï¼š2026-02-14*
